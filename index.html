<!DOCTYPE html>
<html class="h-100" lang="de">
  <head>
    <!-- Bootstrap CSS -->
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
      integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z"
      crossorigin="anonymous"
    />
    <!-- Google Font -->
    <link
      href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap"
      rel="stylesheet"
    />
    <!-- Offener Brief CSS-->
    <link
      rel="stylesheet"
      href="offener-brief.css?v=1.0.1"
      crossorigin="anonymous"
    />
    <!-- Fontawesome -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css"
      integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog=="
      crossorigin="anonymous"
    />
  </head>

  <body class="d-flex flex-column h-100">
    <main class="flex-shrink-0">
      

     
    </main>
    
    

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script
      src="https://code.jquery.com/jquery-3.5.1.min.js"
      integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"
      integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"
      integrity="sha384-B4gt1jrGC7Jh4AgTPSdUtOBvfO8shuf57BaghqFfPlYxofvL8/KUEfYiJOMMV+rV"
      crossorigin="anonymous"
    ></script>

    <!-- Contenfull -->
    <script src="https://cdn.jsdelivr.net/npm/contentful@7.12.1/dist/contentful.legacy.min.js"></script>
    <script>
      var exports = {}; // quick fix because 'exports' is not defined in rich-text bundle below
    </script>
    <script
      src="https://unpkg.com/@contentful/rich-text-html-renderer@12.0.0/dist/rich-text-html-renderer.es5.js"
      charset="utf-8"
    ></script>

    <script>
      $(window).on("load", function () {
        const client = contentful.createClient({
          // This is the space ID. A space is like a project folder in Contentful terms
          space: "5z21gx3h7sb2",
          // This is the access token for this space. Normally you get both ID and the token in the Contentful web app
          accessToken: "ecQ2l4UMTYi1MU3Szr2iNLep8Ak_pNp5i3Nxe1qU3VA",
        });
        // Get the information for the progress bar
        client
          .getEntry("1YkTzVK4KBzfmsMyBqKSo8")
          .then(function (progressBar) {
            progressBar.fields.phases.forEach(function (phase, index) {
              $(".progress-phase-" + (index + 1)).html(phase);
            });
            let numberOfActivePhase = progressBar.fields.numberOfActivePhase;
            if (
              numberOfActivePhase &&
              numberOfActivePhase < progressBar.fields.phases.length
            ) {
              $(".progress-phase-" + numberOfActivePhase).html(
                "<b>" +
                  progressBar.fields.phases[numberOfActivePhase - 1] +
                  "</b>"
              );
              $(".progress-phase-" + numberOfActivePhase)
                .removeClass("bg-light")
                .addClass(
                  "progress-bar-striped progress-bar-animated bg-warning"
                );
            }
          })
          .catch(function (error) {
            console.log(error);
          });

        // Get the whole open letter with the first level of inclueded links
        client
          .getEntries({
            "sys.id": "2aDDbb4AjEQdCo0IW7AnLm",
            order: "sys.createdAt",
            include: 1,
          })
          .then(function (response) {
            let openLetter = response.items[0];
            //Title
            if (openLetter.fields.richTextTitle) {
              $("#Title").html(
                documentToHtmlString(openLetter.fields.richTextTitle)
              );
            } else if (openLetter.fields.title) {
              $("#Title").html(openLetter.fields.title);
            }

            //Addressat
            if (openLetter.fields.addressat) {
              $("#Addressat")
                .children(":first")
                .children(":first")
                .html(openLetter.fields.addressat);
            }
            //Kontakthinweis
            if (openLetter.fields.kontakthinweis) {
              $("#Kontakt")
                .children(":first")
                .html(documentToHtmlString(openLetter.fields.kontakthinweis));
            }

            // Open Letter
            if (openLetter.fields.text) {
              $("#Offener-Brief")
                .children(":first")
                .html(documentToHtmlString(openLetter.fields.text));
            }

            //Signees
            if (
              openLetter.fields.signees &&
              openLetter.fields.signees.length > 0
            ) {
              openLetter.fields.signees.forEach(function (signee) {
                appendSignee(signee);
              });
            }
          })
          .catch(console.error);
      });

      
    </script>
  </body>
</html>
